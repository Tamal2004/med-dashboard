import React from 'react';
import { connect } from 'react-redux';
import Auth from '@aws-amplify/auth';

import { TesterApplication } from './TesterApplicationForm';
import { AuthPiece } from 'aws-amplify-react';

import { fetchPublicClients } from 'actions';
import { PublicTesterFormContainer } from 'views/Containers';

class TesterForm extends AuthPiece {
    constructor(props) {
        super(props);
        this._validAuthStates = ['signUp'];
        this.gotoSignIn = this.gotoSignIn.bind(this);
    }

    componentDidMount() {
        // console.log('Open test form');
        this.props.fetchPublicClients();
        Auth.currentCredentials().then(data =>
            console.log('currentCredentials', data)
        );
    }

    gotoSignIn = () => this.props.onStateChange('signIn', {});

    showComponent(theme) {
        return (
            <PublicTesterFormContainer gotoSignIn={this.gotoSignIn}>
                <TesterApplication noauth />
            </PublicTesterFormContainer>
        );
    }
}

const mapDispatch = {
    fetchPublicClients
};

const _TesterForm = connect(
    null,
    mapDispatch
)(TesterForm);

export { _TesterForm as default, _TesterForm as OpenTesterForm };
