import React from 'react';

import Auth from '@aws-amplify/auth';
import { connect } from 'react-redux';

import { TesterApplication } from './TesterApplicationForm';
import { AuthPiece } from 'aws-amplify-react';

import { fetchPublicClients, signIn } from 'actions';
import { PublicTesterFormContainer } from 'views/Containers';

class TesterForm extends AuthPiece {
    constructor(props) {
        super(props);
        this._validAuthStates = ['signUp'];
        this.gotoSignIn = this.gotoSignIn.bind(this);
    }

    componentDidMount() {
        console.log('Open test form', Auth);
        this.props.fetchPublicClients();
    }

    gotoSignIn = () => this.props.onStateChange('signIn', {});

    showComponent(theme) {
        return (
            <PublicTesterFormContainer gotoSignIn={this.gotoSignIn}>
                <TesterApplication noauth />
            </PublicTesterFormContainer>
        );
    }
}

const mapDispatch = {
    fetchPublicClients,
    signIn
};

const _TesterForm = connect(
    null,
    mapDispatch
)(TesterForm);

export { _TesterForm as default, _TesterForm as OpenTesterForm };
